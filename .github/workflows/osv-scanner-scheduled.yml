name: OSV-Scanner Scheduled Scan

on:
    schedule:
        # Run weekly at Mondays 02:00 UTC
        - cron: '0 2 * * 1'
    # Also run on push to master branch
    push:
        branches: [master]

permissions:
    # Required to upload SARIF file to CodeQL. See: https://github.com/github/codeql-action/issues/2117
    actions: read
    # Require writing security events to upload SARIF file to security tab
    security-events: write
    # Only need to read contents
    contents: read

jobs:
    scan-scheduled:
        # Use full commit SHA for security
        uses: 'google/osv-scanner-action/.github/workflows/osv-scanner-reusable.yml@b77c075a1235514558f0eb88dbd31e22c45e0cd2' # v2.3.0
